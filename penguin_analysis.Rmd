---
title: "penguin_analysis"
output:
  html_document:
    df_print: paged
  pdf_document: default
date: "2024-12-07"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(palmerpenguins)
library(here)
library(janitor)
library(ggplot2)
library(ragg)
library(svglite)
library(viridis)
library(dplyr)
library(grid)  
library(hrbrthemes)
library(gridExtra)
library(scales)
library(knitr)

```

## [QUESTION 1: Data Visualisation for Science Communication]{.underline}

#### a) Producing a Misleading Figure:

```{r bad figure, echo=FALSE, warning=FALSE}

#create a csv file containing only raw data
write_csv(penguins_raw, here("data", "penguins_raw.csv"))

cleaning_penguin_columns <- function(penguins_raw) {
  penguins_raw %>%
    clean_names() %>%
    remove_empty(c("rows", "cols")) %>%
    select(-starts_with("delta")) %>%
    select(-"comments") %>%
    drop_na()  # This will remove rows with any missing values
}

# Loading the raw data again
penguins_raw <- read_csv(here("data", "penguins_raw.csv"), show_col_types = FALSE)

# Running the function:
penguins_clean <- cleaning_penguin_columns(penguins_raw)

# Checking the output


write_csv(penguins_clean, here("data", "penguins_clean.csv"))


# Plot with jittered points for body mass and line for flipper length with separate y-axe

# Plot with jittered points for body mass and line for flipper length with separate y-axes

penguins_clean <- penguins_clean %>%
  filter(!is.na(body_mass_g) & !is.na(flipper_length_mm))

ggplot(penguins_clean, aes(x = species)) +
  geom_jitter(aes(y = body_mass_g), color = "darkgreen", size = 2, width = 0.8) + 
  stat_summary(aes(y = flipper_length_mm), fun = mean, geom = "line", linewidth= 1, color = "blue", group = 1) + 
  stat_summary(aes(y = flipper_length_mm, color = species), fun = mean, geom = "point", size = 3) + 
  scale_y_continuous(
    name = "Body Mass (g)",  # Primary axis for body mass (grams)
    limits = c(0, 6200),  # Set the limits for body mass axis
    sec.axis = sec_axis(
      transform = ~ .,  # Apply transformation to scale flipper length (divide by 20 for example)
      name = "Flipper Length (mm)",  # Name of the secondary axis
      breaks = seq(0, 260, by = 20),  # Set breaks for secondary axis for flipper length
      labels = seq(0, 260, by = 20)  # Display labels for flipper length
    )
  ) +
  theme_ipsum() +
  labs(title = "Penguin Body Mass and Flipper Length by Species") +
  theme(
    axis.title.y.right = element_text(angle = 90, hjust = 0.5),  # Right axis title appearance
    axis.text.y.right = element_text(hjust = 1)  # Adjust text positioning on the right axis
  )


```

##### Figure 1: A comparison of Body Mass (g) and Mean Flipper Lengths (mm) across 3 species of penguin

#### b) Write about how your design choices mislead the reader about the underlying data (200-300 words).

The figure displays a scatter of body mass of 3 different penguin species (all dark green points), and the differences in mean flipper length across these (3 coloured dots, and ajoining line). The figure has a dual-y axis, the left-most axis represents body mass. Here it is presented on the same scale as flipper length, despite body mass varying over a much greater range. This means that many of the differences in flipper length that vary over a comparatively smaller scale, are overlooked by this graph. This makes it wrongly appear as if mean flipper length does not vary across all three species. Furthermore, the small scale makes it difficult to read the mean flipper lengths from each penguin species.

Additionally, the species names on the x axis all overlap, and the key splitting them is in a colour scheme that is not colour-blind friendly. This makes species difficult to differentiate from one another. Moreover, the blue line between them could be confused with the blue coloration of the Gentoo Penguin established in the key.

The dark green representing body mass of all three species do not follow the colour scheme in the legend, which is misleading. Furthermore, the high jitter on these scattered points makes its harder, still, to differentiate differences in body mass across species by augmenting overlap. This overall makes it difficult to discern any meaningful information from this graph.

## [QUESTION 2: Data Pipeline]{.underline}

### Introduction

This study examines differences in culmen depth (depth of the dorsal ridge) and length (the distance from the tip of the upper mandible, and its intersection with the forehead) across 3 species of Penguin. These measurements were sourced from the “palmerpenguins” R package, collected from the Palmer Archipelago, Antarctica (Horst AM,et al, 2020).

The aim of this study is to quantify differences in morphological integration across penguin species. Morphological integration refers to the coordinated variation among traits, influenced by developmental, functional, and evolutionary constraints. Understanding integration is crucial, as it often correlates with phenotypic plasticity, which determines a species' ability to adapt to environmental challenges, such as anthropogenic change.

Beak morphology in penguins is closely associated with diet (Gorman KB, et al, 2014). As a result, the degree of integration between beak traits may play a key role in a species' evolutionary response to pressures such as over-fishing, which may force a dietary shift. By quantifying covariation, we gain crucial insight into the evolutionary flexibility of penguins in response to changing prey availabilities.

### Hypothesis

In this study, I aim to establish whether culmen depth and length are phenotypically integrated, and to what degree this integration varies across three Penguin species. To do so, I will calculate whether the covariance of these two traits varies significantly between different species.

```{r cleaning data, and saving cleaned data}
#changing column names and removing comments
write_csv(penguins_raw, here("data", "penguins_raw.csv"))

cleaning_penguin_columns <- function(penguins_raw){
  penguins_raw %>%
    clean_names() %>%
    remove_empty(c("rows", "cols")) %>% 
    select(-starts_with("delta")) %>%   
    select(-"comments")                   
}

# Loading the raw data
penguins_raw <- read_csv(here("data", "penguins_raw.csv"), show_col_types = FALSE)

# Running the cleaning function (cleaning.R)
penguins_clean <- cleaning_penguin_columns(penguins_raw)

#Saving cleaned data as a new csv file
write_csv(penguins_clean, here("data", "penguins_clean.csv"))



```

```{r, creating explanatory figure, warning=FALSE}
#creating a scatter plot
explanatoryfigure <- ggplot(penguins_clean, aes(x = culmen_length_mm, y = culmen_depth_mm, color = species, shape = species)) +  
  geom_point(size = 3, alpha = 0.7) +  
  # Adjusting size and transparency of points
  theme_minimal() +  
  labs(
    title = "",
    x = "Culmen Length (mm)",  
    y = "Culmen Depth (mm)"
  ) +  
  scale_x_continuous(limits = c(30, 60)) +  
  # Adjusting x-axis range to include all points 
  scale_y_continuous(limits = c(13, 22.5)) +  
  # Adjust y-axis range to include all points
  scale_color_viridis_d() +  
  # Apply viridis color palette for species, colour-blind friendly
  scale_shape_manual(values = c(16, 17, 15))  
# Apply different shapes for 3 species

print(explanatoryfigure)

```

##### Figure 2: Scatter Plot of Culmen Length and Culmen Depth across 3 Penguin Species, split by both colour and shape of point; purple circles are Adelie Penguin, green triangles are Chinstrap Penguin, and yellow squares are Gentoo Penguin. .

### Methods

I will use linear regressions to measure **how culmen depth changes with culmen length**, in each of the three species. I will then generate a p value associated with each regression, to confirm the statistical significance of these relationships.

Then, I will use an Analysis of Covariance (ANCOVA) to analyse the significance of the **interaction between culmen length and species identity** in determining variation in culmen width. This will test if species identity affects the relationship between these traits.

As demonstrated by Figure 6 (supplementary materials) analysis using linear models, as required for both regressions and ANCOVA, is **appropriate** for these data given the displayed normality and homoscedascity of their residuals, and linearity of the relationship between predictor and outcome variables.

Finally, to compare the **differences in the covariance** of these traits across species, I will calculate Pearson's r coefficient for each, transforming this into a Z-score, to generate a p-value- via a Z-test. This value will be used to assess the significance of the differences in the strength of correlations, across the species tested. However, the **suitability of a Z test** is limited by the small sample size and a non-normal distribution of Z-statistics (Figure 7, supplementary materials), which may limit the validity of our conclusions.

Ultimately, this  study will establish if culmen length and depth have a significantly different relationship between species, and whether they are significantly more integrated (more strongly correlated) in different species of Penguin.

### Results

```{r, results figure with p values of slope coefficients, warning=FALSE}

# Fit separate linear models by species, and extract relevant coefficients and p-values

slope_table <- slope_table <- penguins_clean %>% 
  group_by(species) %>% 
#groups penguins_clean by species column
  summarise(
    model = list(lm(culmen_depth_mm ~ culmen_length_mm, data = cur_data())),
    tidied = list(broom::tidy(model[[1]]))
  ) %>% 
#fits a linear model to each species, outputs data as a list in a tidy data frame 
  unnest(tidied) %>% 
#expands list to contain rows, allowing analysis
  filter(term == "culmen_length_mm") %>% 
# select only rows that describe the relationship between culmen length and depth.
  select(species, estimate, p.value) %>% 
 # select the columns containing species, slope coefficients, and p-values.
  rename(slope_coefficient = estimate)
# rename the estimate column to slope_coefficient to make it more reader-friendly.
  


slope_table_formatted <- slope_table %>%
  mutate(formatted_p = pvalue_format()(p.value)) 
# Use pvalue_format() to create a new column containing p-values formatted for readability

# Create a scatter plot, overlaying linear regressions for every species
resultsfigure <- ggplot(penguins_clean, aes(x = culmen_length_mm, y = culmen_depth_mm, color = species, shape = species)) +
  geom_point(alpha = 0.2, position = position_jitter(width = 0.2, height = 0.2)) +  
# Increased transparency, and apply jitter to imporve clarity
  geom_smooth(method = "lm", se = TRUE, aes(fill = species)) +  
# Linear regressions with 95% CIs
  theme_minimal() +
  labs(
    title = "Relationship between Culmen Length and Depth for Penguin Species",
    x = "Culmen Length (mm)",
    y = "Culmen Depth (mm)"
  ) +
  scale_x_continuous(limits = c(30, 60)) +  
# Adjust x-axis range to include all data
  scale_y_continuous(limits = c(13, 22.5)) +  
# Adjust y-axis range to include all data
  scale_color_viridis_d() +  
# Apply viridis (color-blind friendly) colour palette for species
  scale_fill_viridis_d() +  
# Apply viridis color palette for 95% CI
# Add formatted p-values for each slope coefficient
  annotate("text", x = 45.5, y = 22.5, 
           label = paste("Adelie: p",slope_table_formatted$formatted_p[1]),
           size = 4, hjust = 0, vjust = 0, fontface = "bold", color = "black") +
  annotate("text", x = 45.5, y = 22, 
           label = paste("Chinstrap: p", slope_table_formatted$formatted_p[2]),
           size = 4, hjust = 0, vjust = 0, fontface = "bold", color = "black") +
  annotate("text", x = 45.5, y = 21.5, 
           label = paste("Gentoo: p", slope_table_formatted$formatted_p[3]),
           size = 4, hjust = 0, vjust = 0, fontface = "bold", color = "black") +
  theme(legend.position = "right")  
#Position legend to the right of figure

# Display results figure
print(resultsfigure)

```

##### Figure 3a: Correlation between Culmen Length and Depth across 3 Penguin Species. Different colours and shapes represent species, the shaded region around linear regressions represents 95% Confidence Intervals. These intervals indicate the range within which true regressions will fall with 95% certainty. The p-values (top right) indicate wether the slope coefficients are significantly different from 0.

```{r, making table for slope coeffecients}

# Edit the slope_table (produced for explanatory figure) to enhance the readability of it's columns
slopetable_renamed<- slope_table_formatted %>%
  rename(
    "Species" = species,
    "Slope Coefficient" = slope_coefficient,
    "p-value" = p.value,
    "Formatted p-value"= formatted_p)

# Format the table to keep consistent design across all tables.
knitr::kable(slopetable_renamed, format = "markdown", digits = 15, caption = "Slope Coeffecients across Species")
```

##### Figure 3b: Table presenting the slope coefficients and their associated p-values for each species.

Linear regressions found a statistically significant positive relationship between culmen depth and length, across every species (Figure 3a). As demonstrated in Figure 3b, Adelie Penguins displayed the smaller slope coefficients (0.1788) compared to Gentoo and Chinstrap Penguins, of which the Chinstrap Penguins displayed the highest (0.2222, compared to 0.2048). This indicates a lower gradient between culmen length and depth in Adelie Penguins, compared to Gentoo and Chinstraps. This is concordant with the differences in gradients across species' regressions, demonstrated in Figure 3a.

```{r, making ANCOVA summary table}

# Fit an ANCOVA model
ancovamodel <- aov(culmen_depth_mm ~ culmen_length_mm + species + culmen_length_mm:species, data = penguins_clean)

# Provide summary of this model
ancova_summary <- summary(ancovamodel)

# Create a data frame with the relevant results from the summary table
ancova_table_df <- data.frame(
  Source = c("Culmen Length (culmen_length_mm)", "Species", "Culmen Length:Species", "Residuals"),
  Df = ancova_summary[[1]]$Df,
  `Sum Sq` = round(ancova_summary[[1]]$`Sum Sq`, 3),
  `Mean Sq` = round(ancova_summary[[1]]$`Mean Sq`, 3),
  `F value` = round(ancova_summary[[1]]$`F value`, 3),
  `Pr(>F)` = format.pval(ancova_summary[[1]]$`Pr(>F)`, digits = 3))

# Rename columns of data frame for readability
ancova_table <- ancova_table_df %>%
  rename(
    "Source of Variation" = Source,
    "Degrees of Freedom" = Df,
    "Sum of Squares" = Sum.Sq,
    "Mean Square" = Mean.Sq,
    "F-Value" = F.value,
    "P-Value" = Pr..F.)

# Print the table in consistent format
knitr::kable(ancova_table, format = "markdown", digits = 3, caption = "ANCOVA Results for Culmen Depth by Length and Species")

```

##### Figure 4: ANCOVA summary table showing the main effects of culmen length and species on culmen depth, along with the interaction effect between the two.

The ANCOVA, summarised in Figure 4, found a significant difference in the mean culmen depth across species (p\<2e-16), additionally culmen length has a significant effect on culmen depth (p\<2e-16). Moreover, we found the interaction effect between culmen length and species identify was statistically insignificant (p=0.62). Therefore, it is unlikely that the relationship between culmen length and depth varies between species.

```{r, making a table comparing significance of differences in correlation coeffecients}

# Defining a function to analyse statistical significance of the difference between correlation coefficients across species, data= data source (penguins_clean), var1= variable 1 (culmen length), var2= variable 2 (culmen depth), and species_col= species column name (species).

compare_species_correlations <- function(data, var1, var2, species_col) {
  
  # Creating a new variable (correlation_results)  that contains a species' Z score, and it's respective SE.
  correlation_results <- data %>%
    group_by(!!sym(species_col)) %>%
    summarise(
      correlation = cor(!!sym(var1), !!sym(var2), use = "complete.obs"),
      n = n()  
    ) %>%
  # Calculates a correlation coefficient between variable 1 and 2 for each species, calculating sample size for each species
    mutate(
      z = 0.5 * log((1 + correlation) / (1 - correlation)),  
      # New column, transforming correlation coefficients into a Z score
      se = 1 / sqrt(n - 3)  
      # New column containing the standard error for each Z score
    )
  
  
  results_comparison <- combn(correlation_results[[species_col]], 2, simplify = FALSE) %>%
    # Generates a list of all possible pairs of species in correlation_results.
    lapply(function(pair) {
      species_1 <- correlation_results %>% filter(!!sym(species_col) == pair[1])
      species_2 <- correlation_results %>% filter(!!sym(species_col) == pair[2])
      # Extract species 1 and 2 from each pair.
      z_statistic <- abs(species_1$z - species_2$z) / sqrt(species_1$se^2 + species_2$se^2)
      p_value <- 2 * (1 - pnorm(z_statistic))  
      
# Calculates z-statistics between species pairs, calculating a two-tailed p-value corresponding with this statistic for every pair.
    
       data.frame(
        species_1 = pair[1],
        species_2 = pair[2],
        correlation_diff = round(abs(species_1$correlation - species_2$correlation),3),
        z_statistic = round(z_statistic, 3),
        p_value = round(p_value, 3))
    }) %>%
    
# Input results into a data frame, naming pair 1 as species 1, pair 2 as species 2, the difference in correlation coefficients as correlation_diff, z-statistic remains the same, along with with p_value. All these values are rounded to 3 decimal places.
     
    bind_rows() %>%

#Combining multiple rows, collecting results from multiple species pairs inputting them into a single table.
    arrange(p_value)  

# Sorts rows of the data, ordering by ascending p-value.
  
# Format the ordered data frame, changing column names to be more reader-friendly.

  formatted_results <- results_comparison %>%
    rename(
      "Species 1" = species_1,
      "Species 2" = species_2,
      "Difference in Correlation Coefficient" = correlation_diff,
      "Z-Statistic" = z_statistic,
      "P-value" = p_value
    )
  
  return(formatted_results)
}

# Applying function to the data.
correlation_differences <- compare_species_correlations(penguins_clean, "culmen_length_mm", "culmen_depth_mm", "species")

# Displaying the results in a table of consistent format.
knitr::kable(correlation_differences, format = "markdown", digits = 3, caption = "Differences in Correlation Coefficients across Species")

```

##### Figure 5: Table showing the differences in correlation coefficients between pairs of penguin species, along with the corresponding Z-statistics and p-values

However, the strength of these positive correlations did vary significantly across species, as demonstrated in Figure 5. Gentoos and Chinstraps displayed no statistical difference in their correlation coefficients (p=0.909), whereas Adelie penguins had a significantly smaller correlation coefficient than both Gentoos and Chinstraps (p=0.004 and 0.013, respectively). This demonstrates a weaker positive correlation between culmen length and depth in Adelie penguins, in comparison to the stronger correlations displayed in Chinstraps and Gentoos. This is in line with Figure 3a, which displays wider variation of Adelie individuals around their regression line, leading to respectivley wider confidence intervals. Additionally, the lower slope coefficients (0.1767) may further reduce correlation coefficients in Adelie Penguins (Figure 3b).

Across all species, culmen depth significantly increases with culmen length. However, the strength of these positive correlations varied across species. Adelie Penguin displayed the lowest covariance in beak morphology, perhaps due to their lower respective slope coefficients, and their wider variation around the regression line.

### Discussion

The consistent positive correlation across all species, indicates a weak isometric relationship (proportionality) between these traits (Shingleton A, 2010). However, the degree of covariance varies significantly across some species. The significantly higher correlation coefficients in Chinstrap and Gentoo Penguins, suggests higher covariance between culmen length and depth in these two species- compared to Adelie. This perhaps indicates stronger selection pressure in favour for greater phenotypic integration between the traits.

Importantly, these comparisons assume species are independent units, however they all vary in their relatedness. Adelie and Gentoos are more closely related to each other, and Chinstraps are more distantly related to both, but all 3 fall within the same genus, *Pygoscelis* (Ksepka, D.T.,et al, 2006). These different evolutionary relationships could undermine the suitability of comparisons. As in the case of estimated covariance, it is the most distantly related species (Chinstraps and Adelies) that display the largest difference in covariance. Therefore, future studies should better control for evolutionary relationships that may confound comparisons of trait covariance.

Significantly higher Pearson's r coefficients, indicate stronger stabilising selection favouring more integrated beak dimensions in the Chinstrap and Gentoo, than that of the Adelie Penguin. However, the validity of these conclusions is limited by the violation of the assumption of normality in the Z-test (Figure 7, supplementary materials), encouraging future analysis to use non-parametric tests, such as bootstrapping. 

Perhaps, stronger morphological integration could be conferred by a shared regulatory unit between the genes conferring culmen length and shape. Stronger co-regulation could be selected for due to enhanced sexual selection on bill shape, selecting for culmen length to be more closely linked to depth, for instance.

### Conclusion

Across all three species of penguin, culmen depth was positively correlated with culmen length. However, in line with our hypothesis, the strength of this correlation differed significantly across penguin species. Higher covariance was demonstrated in Gentoo and Chinstrap Penguins, compared to Adelies, possibly a result of stronger stabilising selection on beak shape. These significant differences in beak trait covariance could alter the evolutionary response of Adelies to anthropogenic change, relative to other *Pygoscelis* penguins. However, further study is required to establish mechanistic causes of varying covariance; perhaps identifying coregulatory elements of genes conferring beak shape, which may be present in Chinstraps and Gentoos, but absent (or modified) in Adelies.

### Bibliography

Horst AM, Hill AP, Gorman KB (2020). *palmerpenguins: Palmer Archipelago (Antarctica) penguin data*. [doi:10.5281/zenodo.3960218](https://doi.org/10.5281/zenodo.3960218), R package version 0.1.0, <https://allisonhorst.github.io/palmerpenguins/>.

Gorman KB, Williams TD, Fraser WR. Ecological sexual dimorphism and environmental variability within a community of antarctic penguins (Genus Pygoscelis). PLoS One. 2014 Mar 5;9(3):e90081. doi: 10.1371/journal.pone.0090081. PMID: 24599330; PMCID: PMC3943793.

Shingleton AW (Department of Zoology, Michigan State University) © 2010 Nature Education Citation: Shingleton, A. (2010) Allometry: The Study of Biological Scaling. Nature Education Knowledge 3(10):2

Ksepka, D.T., Bertelli, S. and Giannini, N.P. (2006), The phylogeny of the living and fossil Sphenisciformes (penguins). Cladistics, 22: 412-441. https://doi.org/10.1111/j.1096-0031.2006.00116.x

### Supplementary Material

```{r, testing assumptions, warning=FALSE}

# Source residuals and fitted values.
residuals <- resid(ancovamodel)
fitted_values <- fitted(ancovamodel)

# input these statistics into a data frame.
ANCOVAmodel_data <- data.frame(
  residuals = residuals, 
  fitted_values = fitted_values
)

# 1) Q-Q Plot, testing for normality in residuals.
ANCOVA_qq_plot <- ggplot(ANCOVAmodel_data, aes(sample = residuals)) + 
  stat_qq() + 
  stat_qq_line() + 
  ggtitle("Q-Q Plot") + 
  theme_minimal()

# 2) Histogram of residuals, test for normality in residuals.
ANCOVA_hist_plot <- ggplot(ANCOVAmodel_data, aes(x = residuals)) + 
  geom_histogram(binwidth = 1, fill = "lightblue", color = "black", alpha = 0.7) + 
  ggtitle("Histogram of Residuals") + 
  theme_minimal()

# 3) Residuals vs Fitted plot, test for linearity and heteroscedasticity.
ANCOVA_residuals_vs_fitted_plot <- ggplot(ANCOVAmodel_data, aes(x = fitted_values, y = residuals)) + 
  geom_point() + 
  geom_smooth(method = "lm", color = "red", se = FALSE) + 
  ggtitle("Residuals vs Fitted") + 
  theme_minimal()

# 4) Scale-Location plot, test of heteroscedasticity in residuals
ANCOVA_scale_location_plot <- ggplot(ANCOVAmodel_data, aes(x = fitted_values, y = sqrt(abs(residuals)))) + 
  geom_point() + 
  geom_smooth(method = "lm", color = "red", se = FALSE) + 
  ggtitle("Scale-Location Plot") + 
  theme_minimal()

# arrange these graphs in a multi panel, gridEXtra required for this
Assumptionstest<- grid.arrange(ANCOVA_qq_plot, ANCOVA_hist_plot, ANCOVA_residuals_vs_fitted_plot, ANCOVA_scale_location_plot, nrow = 2, ncol = 2)

```

##### Figure 6: Test of the assumptions for linear modelling and ANCOVA

```{r, assumptions of Z-test}

# Checking the normality of the Z-statistics using Shapiro-Wilk test.
shapiro_test_Z_Test <- shapiro.test(correlation_differences$`Z-Statistic`)

print(shapiro_test_Z_Test)

# Plotting the histogram of the Z-statistics, visual test of normality.
Z_test_Hist_plot<- ggplot(correlation_differences, aes(x = `Z-Statistic` )) +
  geom_histogram(color = "black", fill = "lightblue", bins = 10) +
  labs(title = "Histogram of Z-Statistics", x = "Z-Statistic", y = "Frequency") +
  theme_minimal()
  
print(Z_test_Hist_plot)
```

##### Figure 6: Test of the normality asssumption in Z-test


```{r, saving figure, warning=FALSE}
save_plot_png <- function(boxplot, 
                                  filename, size, res, scaling){
  agg_png(filename, width   =  size, 
                    height  =  size, 
                    units   =  "cm", 
                    res     =  res, 
                    scaling =  scaling)
  print(boxplot)
  dev.off()
}

save_plot_png(explanatoryfigure, 
                       here("figures", "beak_scatter_report.png"), 
                       size = 50, res = 500, scaling = 2)

save_plot_png(resultsfigure, 
                       here("figures", "beak_regressions_report.png"), 
                       size = 50, res = 500, scaling = 2)

save_plot_png(ANCOVA_qq_plot, 
                      here("figures", "ANCOVA_qqplot_tests_report.png"), 
                      size = 50, 
                      res = 500, 
                      scaling = 2)

save_plot_png(ANCOVA_scale_location_plot, 
                      here("figures", "ANCOVA_scalelocation_tests_report.png"), 
                      size = 50, 
                      res = 500, 
                      scaling = 2)

save_plot_png(ANCOVA_hist_plot, 
                      here("figures", "ANCOVA_histogram_tests_report.png"), 
                      size = 50, 
                      res = 500, 
                      scaling = 2)

save_plot_png(ANCOVA_residuals_vs_fitted_plot, 
                      here("figures", "ANCOVA_residualsvsfitted_tests_report.png"), 
                      size = 50, 
                      res = 500, 
                      scaling = 2)

save_plot_png(Z_test_Hist_plot, 
                      here("figures", "Z_test_Hist_plot_report.png"), 
                      size = 50, 
                      res = 500, 
                      scaling = 2)


```
## [QUESTION 3: Open Science]{.underline}

#### a) My GitHub link:

https://github.com/StormJH/Penguinassessed
